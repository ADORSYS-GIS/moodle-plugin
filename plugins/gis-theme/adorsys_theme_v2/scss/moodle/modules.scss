/* modules.less */

// The home for small tweaks to modules that don't require
// changes drastic enough to pull in the full module css
// and replace it completely
// Plus some misc. odds and ends

// Define missing variables
$grading-drawer-width: 430px;
$grading-animation-duration: 0.3s;
$grading-icon-button-size: 36px;
$spacers: (
  0: 0,
  1: 0.25rem,
  2: 0.5rem,
  3: 0.75rem,
  4: 1rem,
  5: 1.5rem
);
$grading-search-button-padding-left: calc(0.5rem + 8px);
$grading-search-input-padding-left: calc(0.5rem + 0.5rem + 36px - 2px);
$grading-search-input-padding-right: calc(0.5rem + 36px);
$input-color: #374151;
$input-bg: #ffffff;
$input-border-width: 1px;
$table-border-color: #d1d5db;
$spacer: 1rem;
$font-size-sm: 0.875rem;
$border-width: 1px;
$border-color: #d1d5db;
$white: #ffffff;
$font-size-base: 1rem;
$gray-200: #e5e7eb;
$gray-800: #1f2937;
$h2-font-size: 2rem;

select {
    width: auto;
}

.path-mod {
    .activity-header:not(:empty) {
        background-color: #f3f4f6;
    margin-bottom: 1rem;
    padding-left: 1rem; padding-right: 1rem;
    border-radius: 0.5rem;

        & > div:last-child > div:last-child {
            border-bottom: 0;
        }
    }
    .activity-information {

        .activity-dates {
            padding-top: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #d1d5db;
        }
        .completion-info {
            padding-top: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #d1d5db;
        }
    }
    .activity-description {
        padding-top: 1rem;
        padding-bottom: 1rem;
        & > .box.py-3 {
            padding-top: 0;
            padding-bottom: 0;
        }
        & > .box.py-3:empty {
            display: none;
        }
    }
    .automatic-completion-conditions .badge {
        font-size: 0.75rem;
        line-height: 1rem;
        padding: 0.5rem;
        margin-top: 0.5rem;
        mix-blend-mode: multiply;
        &.badge-light {
            background-color: #e5e7eb;
        }

        .icon {
            width: 0.75rem;
            height: 0.75rem;
            font-size: 0.75rem;
            line-height: 1rem;
        }

        &:first-child {
            margin-top: 0;
        }
    }
    .activity-description .no-overflow p:last-child {
        padding-bottom: 0;
        margin-bottom: 0;
    }
}

// Choice module

.path-mod-choice {
    .horizontal .choices .option {
        display: inline-block;
    }
}

.path-mod-choice {
    .choices .option label {
        vertical-align: top;
    }
}

// Forum module

.path-mod-forum .forumsearch {
    input,
    .helptooltip {
        margin: 0.125rem;
    }
}

.path-mod-forum .forumheaderlist,
.path-mod-forum .forumheaderlist td {
    border: none;
}

.path-mod-forum {
    .forumheaderlist {
        thead .header,
        tbody .discussion td {
            white-space: normal;
            vertical-align: top;
            padding-left: 0.5rem;
            padding-right: 0.5rem;
        }

        thead .header {
            white-space: normal;
            vertical-align: top;
        }

        thead .header.replies {
            text-align: center;
        }

        thead .header.lastpost {
            text-align: right;
        }

        thead .header th,
        tbody .discussion td {
            &.discussionsubscription {
                width: 1rem;
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }
        }

        .discussion {
            .replies,
            .lastpost {
                white-space: normal;
            }

            .discussionsubscription,
            .replies {
                text-align: center;
            }

            .topic,
            .discussionsubscription,
            .topic.starter,
            .replies,
            .lastpost {
                vertical-align: top;
            }
        }
    }

    .discussion-list {
        .topic {
            // Do not use the default bold style for the table headings.
            font-weight: 400;
        }
    }
}

.discussion-settings-container {
    .form-select {
        width: 100%;
    }

    input {
        max-width: 100%;
    }
}

.forumpost {
    border: 1px solid #d1d5db;
    display: block;
    padding: 0.375rem;

    .header {
        margin-bottom: 0.125rem;
    }

    .picture img {
        margin: 0.125rem;

        &.userpicture {
            margin-left: 0.125rem;
            margin-right: 0.625rem;
        }
    }

    .content {
        .posting.fullpost {
            margin-top: 0.5rem;
        }
    }

    .row {
        display: block;
        .topic,
        .content-mask,
        .options {
            margin-left: 3rem;
        }

        &.side {
            clear: both;
        }
    }
}

.forumpost .row .left {
    width: 3rem;
}

.forumpost .options .commands {
    margin-left: 0;
}

.forumpost .subject {
    font-weight: 700;
}

// Override hardcoded forum modules styling
.forumsearch input[type=text] {
    margin-bottom: 0;
}

#page-mod-forum-view {
    table {
        .fit-content {
            width: 1px;
            white-space: nowrap;
        }

        .limit-width {
            max-width: 200px;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;

            .author-info {
                max-width: calc(100% - 35px - 0.5rem);
            }
        }
    }
}

// Comment out Sass variables and use Tailwind theme() directly or define in tailwind.config.js
// $author-image-width: 70px;
// $author-image-margin: 24px;
// $author-image-width-sm: 30px;
// $author-image-margin-sm: 8px;

/** Gently highlight the selected post by changing it's background to blue and then fading it out. */
@keyframes background-highlight {
    from {
        background-color: #dbeafe;
    }
    to {
        background-color: inherit;
    }
}

.path-mod-forum .nested-v2-display-mode,
.path-mod-forum.nested-v2-display-mode {
    .discussionsubscription {
        margin-top: 0;
        color: inherit;
        margin-bottom: 0;
    }

    .preload-subscribe,
    .preload-unsubscribe {
        display: none;
    }

    .post-message {
        line-height: 1.625;
    }

    .indent {
        margin-left: 0;
    }

    /** Reset the badge styling back to pill style. */
    .badge {
        color: inherit;
        font-family: inherit;
        font-weight: inherit;
        padding-left: 0.5rem;
        padding-right: 0.5rem;
        padding-top: 0.125rem;
        padding-bottom: 0.125rem;
        border-radius: 9999px;
    }

    .badge-light {
        background-color: #e5e7eb;
    color: #1f2937;
    }

    /** Style the ratings like a badge. */
    .rating-aggregate-container {
        background-color: #e5e7eb;
        color: #1f2937;
        padding-left: 0.5rem;
        padding-right: 0.5rem;
        padding-top: 0.25rem;
        padding-bottom: 0.25rem;
        line-height: 1;
        margin-right: 0.5rem;
        vertical-align: middle;
        border-radius: 9999px;
        text-align: center;
    }

    .ratinginput {
        padding-left: 0.75rem;
        padding-right: 0.75rem;
        padding-top: 0.25rem;
        padding-bottom: 0.25rem;
        line-height: 1;
        height: auto;
        border-radius: 9999px;

        @media (min-width: 768px) {
            margin-top: 0.5rem;
        }
    }

    .group-image {
        width: 2.25rem;
        height: 2.25rem;
        margin-right: 0;
        float: none;
        display: inline-block;
    }

    /** Don't show the discussion locked alert in this mode because it's already indicated with a badge. */
    .alert.discussionlocked {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
    }

    /** Fix muted text contrast ratios for accessibility. */
    .text-muted,
    .dimmed_text {
        color: #4b5563; /* stylelint-disable-line declaration-no-important */
    }

    .author-header {
        font-style: italic;

        .author-name {
            font-style: normal;
        }
    }

    /** Make the tag list text screen reader visible only */
    .tag_list > b {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
    }

    :target > .focus-target {
        animation-name: background-highlight;
        animation-duration: 1s;
        animation-timing-function: ease-in-out;
        animation-iteration-count: 1;
    }

    .forum-post-container {
        .replies-container {
            .forum-post-container {
                border-top: 1px solid #d1d5db;
                padding-top: 1.5rem;

                .replies-container .forum-post-container {
                    border-top: 0;
                    padding-top: 0;
                }
            }

            .inline-reply-container .reply-author {
                display: none;
            }
        }

        .post-message p:last-of-type {
            margin-bottom: 0;
        }

        .author-image-container {
            width: 70px;
            margin-right: 24px;
            flex-shrink: 0;
        }

        .inline-reply-container textarea {
            border: 0;
            resize: none;
        }

        .indent {
            /**
             * The first post and first set of replies have a larger author image so offset the 2nd
             * set of replies by the image width + margin to ensure they align.
             */
            .indent {
                padding-left: calc(70px + 24px);

                /**
                 * Reduce the size of the the author image for all second level replies (and below).
                 */
                .author-image-container {
                    width: 30px;
                    margin-right: 8px;
                    padding-top: calc((36px - 30px) * 0.5);
                }

                /**
                 * Adjust the indentation offset for all 3rd level replies and below for the smaller author image.
                 */
                .indent {
                    padding-left: calc(30px + 8px);

                    /**
                     * Stop indenting the replies after the 5th reply.
                     */
                    .indent .indent .indent {
                        padding-left: 0;
                    }
                }
            }
        }
    }
}

/** Extra small devices (portrait phones, less than 576px). */
@media (min-width: 768px) {
    #page-mod-forum-discuss.nested-v2-display-mode {
        .forum-post-container {
            .author-image-container {
                width: 30px;
                margin-right: 8px;
            }

            .indent {
                .indent {
                    padding-left: calc(30px + 8px);

                    .indent .indent {
                        padding-left: 0;
                    }
                }
            }
        }

        .group-image {
            width: 1.75rem;
            height: 1.75rem;
        }
    }
}

// Make filter popover content scrollable if needed.
.filter-scrollable {
    overflow-y: auto;
    max-height: 25em;
    margin-bottom: 1rem;
}

// Required to fit a date mform into a filter popover.
.filter-dates-popover {
    width: 100%;
    max-width: 41.5em;
}

// Comment out Sass variables and use Tailwind theme() directly or define in tailwind.config.js
// $grading-drawer-width: 430px !default;
// $grading-animation-duration: .3s !default;
// $grading-icon-button-size: 36px !default;
// $grading-search-button-padding-left: calc(#{map-get($spacers, 2)} + 8px) !default;
// $grading-search-input-padding-left: calc(#{map-get($spacers, 2)} + #{map-get($spacers, 2)} + #{$grading-icon-button-size} - calc(#{$input-border-width} * 2)) !default; /* stylelint-disable-line max-line-length */
// $grading-search-input-padding-right: calc(#{map-get($spacers, 2)} + #{$grading-icon-button-size}) !default;
// $grading-nav-bar-active-drawer-button-bottom: calc(#{map-get($spacers, 2) * -1} - 1px) !default;
// $grading-content-show-content-button-padding-left: calc(#{map-get($spacers, 2) * 2} + 45px) !default;

// $input-line-height-lg:  1.5 !default;

@keyframes expandSearchButton {
    from {
        height: 2.25rem;
        width: 2.25rem;
        border-radius: 1.125rem;
        background-color: #e5e7eb;
    }
    to {
        width: 100%;
        height: 3rem;
        border-radius: 0;
        background-color: #ffffff;
        border-color: #d1d5db;
        padding-left: calc(0.5rem + 8px);
        padding-top: 0.75rem;
        padding-bottom: 0.75rem;
        font-size: 1.125rem;
        line-height: 1.5;
        right: 0;
    }
}

@keyframes collapseSearchButton {
    from {
        width: 100%;
        height: 3rem;
        border-radius: 0;
        background-color: #ffffff;
        border-color: #d1d5db;
        padding-left: calc(0.5rem + 8px);
        padding-top: 0.75rem;
        padding-bottom: 0.75rem;
        font-size: 1.125rem;
        line-height: 1.5;
        right: 0;
    }
    to {
        height: 2.25rem;
        width: 2.25rem;
        border-radius: 1.125rem;
        background-color: #e5e7eb;
    }
}

.path-mod-forum .unified-grader {
    @media (min-width: 0px) {
        .navbar {
            max-height: none;
            z-index: 10;
        }
    }

    .body-container {
        overflow: auto;
        &.hidden {
            display: none; /* stylelint-disable-line declaration-no-important */
        }
    }

    .userpicture {
        height: 3.75rem;
        width: 3.75rem;
    }

    .grader-grading-panel {
        top: 0;
        position: absolute;
        height: 100%;
        z-index: 0;
        width: $grading-drawer-width;

        &.hidden {
            right: ($grading-drawer-width * -1);
        }

        .grading-icon {
            width: $grading-icon-button-size;
        }

        .user-picker-container {
            .user-full-name {
                max-width: 240px;
            }

            .page-link {
                width: $grading-icon-button-size;
                height: $grading-icon-button-size;
                display: flex;
                text-align: center;
                align-items: center;
                justify-content: center;
            }
        }

        .header-container {
            height: 65px;
            position: relative;
            overflow: hidden;

            .info-container {
                position: absolute;
                top: 50%;
                left: 0;
                transform: translateY(-50%);
                width: 100%;
                height: 100%;
                padding: map-get($spacers, 2);
                padding-right: calc(#{$grading-icon-button-size} + #{map-get($spacers, 2)});
                opacity: 1;
                visibility: visible;
                transition: left $grading-animation-duration ease-in-out;
                z-index: 1;
            }

            .toggle-search-button {
                &.expand {
                    animation-name: expandSearchButton;
                    animation-duration: $grading-animation-duration;
                    animation-timing-function: ease-in-out;
                }

                &.collapse {
                    display: block;
                    animation-name: collapseSearchButton;
                    animation-duration: $grading-animation-duration;
                }
            }

            .user-search-container {
                overflow: hidden;
                position: absolute;
                top: 50%;
                right: 0;
                transform: translateY(-50%);
                z-index: 2;
                width: 100%;
                height: 100% !important; /* stylelint-disable-line declaration-no-important */
                padding: map-get($spacers, 2);

                .search-input-container {
                    position: relative;
                    overflow: visible;
                    flex-wrap: nowrap;

                    input {
                        padding-left: $grading-search-input-padding-left;
                        padding-right: $grading-search-input-padding-right;
                        opacity: 1;
                        visibility: visible;
                        transition:
                            opacity 0s linear $grading-animation-duration,
                            visibility 0s linear;
                    }

                    .search-icon {
                        position: absolute;
                        top: 50%;
                        left: map-get($spacers, 2);
                        transform: translateY(-50%);
                        color: $input-color;
                        height: $grading-icon-button-size;
                        width: calc(#{$grading-icon-button-size} - calc(#{$input-border-width} * 2));
                        background-color: $input-bg;
                        opacity: 1;
                        visibility: visible;
                        transition:
                            opacity 0s linear $grading-animation-duration,
                            visibility 0s linear $grading-animation-duration;
                    }

                    .toggle-search-button {
                        position: absolute;
                        top: 50%;
                        right: map-get($spacers, 2);
                        transform: translateY(-50%);
                        z-index: 1;
                        color: inherit;
                        text-align: left;
                        padding-left: 9px;
                        transition: right 0s linear $grading-animation-duration;

                        .expanded-icon {
                            opacity: 1;
                            visibility: visible;
                            max-width: 50px;
                            max-height: 50px;
                            transition:
                                opacity 0s linear $grading-animation-duration,
                                max-height 0s linear $grading-animation-duration,
                                max-width 0s linear $grading-animation-duration,
                                visibility 0s linear $grading-animation-duration;
                        }

                        .collapsed-icon {
                            opacity: 0;
                            visibility: hidden;
                            max-height: 0;
                            max-width: 0;
                            overflow: hidden;
                            transition:
                                opacity 0s linear $grading-animation-duration,
                                max-height 0s linear $grading-animation-duration,
                                max-width 0s linear $grading-animation-duration,
                                visibility 0s linear $grading-animation-duration;
                        }
                    }
                }

                &.collapsed {
                    width: calc(#{$grading-icon-button-size} + #{map-get($spacers, 2)} + #{map-get($spacers, 2)});
                    transition: width $grading-animation-duration ease-in-out;

                    .search-input-container {
                        flex-wrap: nowrap;

                        input,
                        .search-icon {
                            opacity: 0;
                            visibility: hidden;
                            transition:
                                opacity 0s linear,
                                visibility 0s linear;
                        }

                        input {
                            padding-left: 0;
                            padding-right: 0;
                        }

                        .toggle-search-button {
                            .expanded-icon {
                                opacity: 0;
                                visibility: hidden;
                                max-height: 0;
                                max-width: 0;
                                overflow: hidden;
                                transition:
                                    opacity 0s linear,
                                    max-height 0s linear,
                                    max-width 0s linear,
                                    visibility 0s linear;
                            }

                            .collapsed-icon {
                                opacity: 1;
                                visibility: visible;
                                max-width: 50px;
                                max-height: 50px;
                                transition:
                                    opacity 0s linear,
                                    max-height 0s linear,
                                    max-width 0s linear,
                                    visibility 0s linear;
                            }
                        }
                    }
                }
            }

            .user-search-container:not(.collapsed) + .info-container {
                opacity: 0;
                visibility: hidden;
                left: calc(100% * -1);
                transition:
                    left $grading-animation-duration ease-in-out,
                    opacity 0s linear $grading-animation-duration,
                    visibility 0s linear $grading-animation-duration,
                    padding 0s linear $grading-animation-duration;
            }
        }
    }

    .grader-module-content {
        overflow-y: auto;
        margin-right: 430px;
        transition-property: all;
        transition-duration: 200ms;
        transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    }

    .drawer-button {
        position: relative;

        &.active::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 100%;
            height: 1px;
            background-color: var(--fallback-p, oklch(var(--p) / 1));
        }

        .icon {
            font-size: 1.25rem;
            line-height: 1.75rem;
            height: 1.25rem;
            width: 1.25rem;
        }
    }

    .grader-module-content-display {
        .discussion-container {
            &:last-of-type {
                > hr {
                    display: none;
                }
            }

            .posts-container {
                &:last-of-type {
                    > hr {
                        display: none;
                    }
                }

                .parent-container {
                    position: relative;

                    .show-content-button {
                        position: absolute;
                        height: 100%;
                        width: 100%;
                        left: 0;
                        top: 0;
                        text-align: left;
                        z-index: 10;
                        padding-left: calc(0.5rem * 2 + 45px);

                        &:not(.collapsed) {
                            display: none;
                        }
                    }

                    .content {
                        display: block;
    height: auto; /* stylelint-disable-line declaration-no-important */

                        .header {
                            transition-property: all;
    transition-duration: 300ms;
    transition-timing-function: ease-in-out;

                            div + div {
                                opacity: 1;
    visibility: visible;
    max-height: none;
    transition-property: opacity;
    transition-duration: 300ms;
                                transition-property: opacity, visibility;
                            }
                        }

                        .body-content-container {
                            opacity: 1;
    visibility: visible;
    max-height: none;
    transition-property: opacity;
    transition-duration: 300ms;
                            transition-property: opacity, visibility;
                        }

                        .forum-post-core {
                            opacity: 1;
    visibility: visible;
    max-height: none;
    transition-property: opacity;
    transition-duration: 300ms;
                            transition-property: opacity, visibility;
                        }
                    }

                    .show-content-button.collapsed + .content {
                        opacity: 0.3;

                        .header {
                            margin-bottom: 0; /* stylelint-disable-line declaration-no-important */

                            div + div {
                                opacity: 0;
                                visibility: hidden;
                                max-height: 0;
                            }
                        }

                        .body-content-container {
                            opacity: 0;
                            visibility: hidden;
                            max-height: 0;
                        }

                        .forum-post-core {
                            opacity: 0;
                            visibility: hidden;
                            max-height: 0;
                        }
                    }

                    .show-content-button.collapsed:hover + .content,
                    .show-content-button.collapsed:focus + .content {
                        opacity: 1;
                    }
                }
            }
        }

        .no-post-container {
            .icon {
                height: 250px;
                width: 250px;
                margin-right: 0;
            }
        }

        .nested-v2-display-mode {
            .discussion-container {
                .posts-container {
                    .parent-container {
                        .show-content-button {
                            padding-left: calc(70px + 24px);
                        }
                    }
                }
            }
        }
    }

    .no-search-results-container {
        .icon {
            height: 250px;
            width: 250px;
            margin-right: 0;
        }
    }

    .nested-v2-display-mode {
        .view-context-button {
            margin-left: calc(70px + 24px);
            border-radius: 0.5rem;
        }

        .parent-container {
            position: relative;

            &:after {
                position: absolute;
                background-color: #e5e7eb;
                width: 0.125rem;
                top: calc(70px + 0.5rem);
                content: "";
                height: calc(100% - 70px + 0.5rem);
            }
        }

        .parent-container + .post-container {
            .author-image-container {
                img {
                    width: 30px;
                }
            }
        }
    }
}

.path-mod-forum .unified-grader .nested-v2-display-mode,
.path-mod-forum .modal .nested-v2-display-mode {
    .post-subject {
        display: none;
    }
}

@media (min-width: 640px) {
    .path-mod-forum .unified-grader {
        .grader-grading-panel {
            width: 100%;
            position: fixed;
            height: calc(100vh - 50px);
            overflow: scroll;
            top: 50px;
        }
        .body-container {
            overflow: visible;
        }
    }
}

// End styling for mod_forum.

.maincalendar .calendarmonth td,
.maincalendar .calendarmonth th {
    border: 1px dotted $table-border-color;
}

.path-grade-report-grader h1 {
    text-align: inherit;
}

#page-mod-data-view #singleimage {
    width: auto;
}

.template_heading {
    margin-top: 10px;
}

.breadcrumb-button {
    margin-top: 4px;
}

.breadcrumb-button .singlebutton {
    float: left;
    margin-left: 4px;
}

.langmenu form {
    margin: 0;
}
// contributed by Paul Hibbitts, see http://msdn.microsoft@mixin com/en-us/library/ie/jj583807(v=vs.85).aspx
canvas {
    -ms-touch-action: auto;
}

div#dock {
    display: none;
}

// Choice module

// Lesson module

/** General styles (scope: all of lesson) **/
.path-mod-lesson .invisiblefieldset.fieldsetfix {
    display: block;
}
.path-mod-lesson .answeroption .checkbox label p {
    display: inline;
}
.path-mod-lesson .slideshow {
    overflow: auto;
    padding: 15px;
}
#page-mod-lesson-view .branchbuttoncontainer .singlebutton button[type="submit"] {
    white-space: normal;
}
#page-mod-lesson-view {
    .vertical .singlebutton {
        display: block;
        + .singlebutton {
            margin-left: 0;
            margin-top: 1rem;
        }
    }
    .fitem .felement .form-select {
        align-self: flex-start;
    }
}
.path-mod-lesson .table td {
    vertical-align: middle;
    label {
        margin-bottom: 0;
    }
    .highlight {
        display: inline-block;
        margin-left: 0.25rem;
    }
    input[type="checkbox"] {
        display: block;
    }
}

.path-mod-wiki .wiki_headingtitle,
.path-mod-wiki .midpad,
.path-mod-wiki .wiki_headingtime {
    text-align: inherit;
}

.path-mod-wiki .wiki_contentbox {
    width: 100%;
}

.nav .caret {
    margin-left: 4px;
}

// Dividers
.nav {
    .divider {
        overflow: hidden;
        width: 0;
    }
}

// Usermenu
.userloggedinas,
.userswitchedrole,
.loginfailures {
    .usermenu {
        .usertext {
            float: left;
            text-align: right;
            margin-right: $spacer * 0.5;
            height: 35px;
            .meta {
                font-size: $font-size-sm;
                align-items: center;
            }
        }
        .avatar {
            img {
                margin: 0;
            }
        }
    }
}

.userloggedinas .usermenu {
    .userbutton .avatars {
        position: relative;
        display: inline-block;
        .avatar {
            &.current {
                display: inline-block;
                position: absolute;
                bottom: 0;
                right: 0;
                width: 20px;
                height: 20px;
                border-radius: 50%;
                img {
                    vertical-align: baseline;
                }
                .userinitials.size-35 {
                    width: 20px;
                    height: 20px;
                    border: $border-width solid $border-color;
                    background-color: $white;
                    font-size: $font-size-base * .6;
                }
            }
            img {
                width: inherit;
                height: inherit;
            }
        }
        .realuser {
            width: 35px;
            height: 35px;
            display: inline-block;
        }
    }
}

.userinitials {
    background-color: $gray-200;
    vertical-align: middle;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    color: $gray-800;
    font-weight: normal;
    margin-right: $spacer * 0.25;
    &.size-16,
    &.size-30 {
        font-size: 0.7rem;
        width: 30px;
        height: 30px;
    }
    &.size-35 {
        width: 35px;
        height: 35px;
    }
    &.size-50 {
        width: 50px;
        height: 50px;
    }
    &.size-64 {
        width: 64px;
        height: 64px;
    }
    &.size-100 {
        width: 100px;
        height: 100px;
        font-size: $h2-font-size;
    }
}

img.userpicture {
    margin-right: $spacer * 0.25;
}

@media (max-width: 768px) {
    .usertext {
        display: none;
    }
}

// Quiz module
#page-mod-quiz-mod #id_reviewoptionshdr .col-md-3,
#page-mod-quiz-mod #id_reviewoptionshdr .col-md-9 {
    width: auto;
    max-width: none;
}

#page-mod-quiz-mod #id_reviewoptionshdr .fcontainer > .fitem {
    float: left;
    width: 20rem;
    display: inline-block;
    min-height: 12rem;
}

#page-mod-quiz-mod #id_reviewoptionshdr .btn-link {
    line-height: normal;
    vertical-align: bottom;
}
#page-mod-quiz-mod #id_reviewoptionshdr .form-check {
    width: auto;
    height: 1.375rem;
    display: flex;
    justify-content: flex-start;
}

#page-mod-quiz-mod #id_reviewoptionshdr .review_option_item {
    width: 90%;
    height: 1.375rem;
}

// Question navigation block.
.path-mod-quiz #mod_quiz_navblock {
    .qnbutton {
        text-decoration: none;
        font-size: 14px;
        line-height: 20px;
        font-weight: normal;
        text-decoration: none;
        font-size: 0.875rem;
        line-height: 1.25rem;
        line-height: 1.25;
        font-weight: 400;
        background-color: var(--fallback-b1, oklch(var(--b1) / 1));
        height: 2.5rem;
        width: 1.75rem;
        border-radius: 0.125rem;
        border: 0;
        overflow: hidden;
        white-space: nowrap;
        margin: 0.125rem;
    }

    span.qnbutton {
        cursor: default;
    background-color: #e5e7eb;
    color: #374151;
    }

    a.qnbutton:hover,
    a.qnbutton:active,
    a.qnbutton:focus {
        text-decoration: underline;
    }

    .qnbutton .thispageholder {
        border: 1px solid;
        border-radius: 0.125rem;
        z-index: 10;
    }

    .qnbutton.thispage .thispageholder {
        border-width: 3px;
    }

    .allquestionsononepage .qnbutton.thispage .thispageholder {
        border: 1px solid;
    }

    .qnbutton .trafficlight {
        border: 0;
        background-color: var(--fallback-b1, oklch(var(--b1) / 1));
        background-position: center;
        background-repeat: no-repeat;
        background-size: auto;
        height: 1.25rem;
        margin-top: 1.25rem;
        border-bottom-left-radius: 0.125rem;
        border-bottom-right-radius: 0.125rem;
        background-size: 10px;
    }

    .qnbutton.correct .thispageholder {
        border-color: var(--fallback-su, oklch(var(--su) / 1));
    }

    .qnbutton.incorrect .thispageholder {
        border-color: var(--fallback-er, oklch(var(--er) / 1));
    }

    .qnbutton.partiallycorrect .thispageholder {
        border-color: var(--fallback-wa, oklch(var(--wa) / 1));
    }

    .qnbutton.correct,
    .qnbutton.correct .trafficlight {
        background-color: #dcfce7;
    }

    .qnbutton.incorrect,
    .qnbutton.incorrect .trafficlight {
        background-color: #fee2e2;
    }

    .qnbutton.partiallycorrect,
    .qnbutton.partiallycorrect .trafficlight {
        background-color: #fef9c3;
    }

    .qnbutton.blocked,
    .qnbutton.blocked .trafficlight,
    .qnbutton.complete,
    .qnbutton.complete .trafficlight,
    .qnbutton.answersaved,
    .qnbutton.answersaved .trafficlight,
    .qnbutton.requiresgrading,
    .qnbutton.requiresgrading .trafficlight {
        background-color: #d1d5db;
    }

    .qnbutton.notyetanswered .trafficlight,
    .qnbutton.invalidanswer .trafficlight {
        background-color: #ffffff;
    }

    .qnbutton.correct .trafficlight {
        background-image: url([[pix:core|i/grade_correct]]);
        color: var(--fallback-su, oklch(var(--su) / 1));
        background-size: 14px;
    }

    .qnbutton.blocked .trafficlight {
        background-image: url([[pix:core|t/locked]]);
    }

    .qnbutton.notanswered .trafficlight,
    .qnbutton.incorrect .trafficlight {
        background-image: url([[pix:core|i/grade_incorrect]]);
        color: var(--fallback-er, oklch(var(--er) / 1));
        background-size: 14px;
    }

    .qnbutton.partiallycorrect .trafficlight {
        background-image: url([[pix:core|i/grade_partiallycorrect]]);
        color: var(--fallback-wa, oklch(var(--wa) / 1));
        background-size: 14px;
    }

    .qnbutton.complete .trafficlight,
    .qnbutton.answersaved .trafficlight,
    .qnbutton.requiresgrading .trafficlight {
        background-color: #d1d5db;
    }
}

#page-mod-quiz-edit ul.slots li.section li.activity .instancemaxmarkcontainer form input {
    height: 1.4em;
    vertical-align: middle;
}

#page-mod-quiz-edit ul.slots li.section li.activity .instancemaxmarkcontainer {
    padding-top: 0.5rem;
    padding-bottom: 0.5rem;
    padding-left: 0.125rem;
    padding-right: 0.125rem;
    margin: 0.125rem;
}

/* Override the color of the quiz attempt icons for accessibility. */
#attemptsform,
.formulation .answer {
    .icon.text-success {
        color: var(--fallback-su, oklch(var(--su) / 1)) !important;
    }
    .icon.text-danger {
        color: var(--fallback-er, oklch(var(--er) / 1)) !important;
    }
    .icon.text-warning {
        color: var(--fallback-wa, oklch(var(--wa) / 1)) !important;
    }
}

/* Countdown timer. */
#page-mod-quiz-attempt #region-main {
    overflow-x: inherit;
}

#quiz-timer-wrapper {
    display: none;
    position: sticky;
    justify-content: flex-end;
    top: calc(50px + 0.3125rem);
    z-index: 1020;
    #quiz-timer {
        border: 1px solid #ef4444;
        background-color: #ffffff;
    }
}
.pagelayout-embedded #quiz-timer-wrapper {
    top: 0.3125rem;
}

// Assign.
.path-mod-assign [data-region="grade-actions-panel"] [data-region="grade-actions"] .collapse-buttons {
    top: auto;
}

// This section removes the responsiveness from the form in the grading panel
.path-mod-assign #page-content [data-region="grade-panel"] .mform:not(.unresponsive) .fcontainer .fitem.popout .felement {
    height: calc(100% - 4rem);
}

.path-mod-assign [data-region="grade-panel"] {
    padding-top: 1rem;
}
.path-mod-assign [data-region="grade-panel"] .fitem > .col-md-3,
.path-mod-assign [data-region="grade-panel"] .fitem > .col-md-9 {
    width: 100%;
    padding: 0;
    max-width: 100%;
    flex: none;
}
.path-mod-assign [data-region="grade-panel"] fieldset,
.path-mod-assign [data-region="grade-panel"] .fitem.row {
    margin: 0;
}

.path-mod-assign [data-region="grade-panel"] .mform .fitem.has-popout .felement {
    width: 100%;
    overflow: auto;
    height: calc(100% - 4rem);
}

.path-mod-assign [data-region="grade-panel"] .mform .fitem .felement {
    width: auto;
}

// Now styles for the popout sections.

.path-mod-assign [data-region="grade-panel"] .popout {
    background-color: #ffffff;
}

.path-mod-assign [data-region="grade-panel"] .fitem.has-popout {
    background-color: #ffffff;
    border-radius: 0.5rem;
    border: 1px solid;
    border-color: #e5e7eb;
    padding: 1rem;
    margin-bottom: 1rem;
}
.path-mod-assign [data-region="grade-panel"] .has-popout .col-md-3 {
    border-bottom: 1px solid #e5e7eb;
    margin-bottom: 1rem;
}


.path-mod-assign [data-region="grade-panel"] .popout > .col-md-3 {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    font-size: 1.25rem;
    line-height: 1.75rem;
}

.path-mod-assign [data-region="grade-panel"] .popout [data-region="popout-button"] {
    margin-top: 0;
}

// Now style the fixed header elements.

.path-mod-assign [data-region="assignment-info"] {
    overflow-y: hidden;
}

.path-mod-assign [data-region="grading-navigation"] {
    padding: 0.375rem;
}

.path-mod-assign [data-region="grade-actions"] {
    padding: 0.625rem;
}

.path-mod-assign [data-region="user-info"] .img-rounded {
    margin-top: 0;
}

.path-mod-assign [data-region="grading-navigation-panel"] {
    height: 85px;
}

@media (max-width: 767px) {
    .path-mod-assign [data-region="grading-navigation-panel"] {
        height: auto;
    }
    .path-mod-assign [data-region="user-info"] {
        margin-top: 1rem;
    }
}

.path-mod-assign [data-region="grading-navigation"] [data-region="input-field"] input {
    width: auto;
    display: inline-block;
}

/**
 * Assign feedback.
 */
.assignfeedback_editpdf_widget * {
    box-sizing: content-box;
}

.assignfeedback_editpdf_widget button {
    box-sizing: border-box;
}

.assignfeedback_editpdf_widget .commentcolourbutton img {
    border: 0;
}

.assignfeedback_editpdf_widget .label {
    position: relative;
    padding-top: 0.5rem;
    padding-bottom: 0.5rem;
    padding-left: 0.75rem;
    padding-right: 0.75rem;
    margin-bottom: 0.75rem;
    border: 1px solid transparent;
    color: var(--fallback-in, oklch(var(--in) / 1));
    border-color: var(--fallback-in, oklch(var(--in) / 1));
    background-color: var(--fallback-in, oklch(var(--in) / 1));
    border-radius: 0.375rem;
}

.assignfeedback_editpdf_menu {
    padding: 0;
}

.path-mod-assign [data-region="grade-panel"] .gradingform_guide .remark .commentchooser {
    float: none;
}
.path-mod-assign [data-region="grade-panel"] .gradingform_guide .markingguideremark {
    width: 100%;
}
.path-mod-assign [data-region="grade-panel"] .mform .fitem .felement[data-fieldtype="grading"] {
    padding-left: 1rem; padding-right: 1rem;
}
.path-mod-assign [data-region="grade-panel"] .showmarkerdesc,
.path-mod-assign [data-region="grade-panel"] .showstudentdesc {
    background-color: #ffffff;
}

.path-mod-assign .gradingtable thead tr {
    position: sticky;
    z-index: 10;
    top: 50px;
}

/**
 * Mod LTI.
 */
.path-admin-mod-lti {
    .btn .loader img,
    #tool-list-loader-container .loader img {
        height: auto;
    }
}

/**
 * Mod Feedback.
 */

.path-mod-feedback {
    span.feedback_info {
        font-weight: 700;
    }
    div.feedback_is_dependent {
        background-color: #4b5563;
    }
    span.feedback_depend {
        color: var(--fallback-er, oklch(var(--er) / 1));
    }
    hr.feedback_pagebreak {
        height: 0.25rem;
        background-color: #4b5563;
        border: 0;
        margin: 0;
    }
    .feedback_bar_image {
        height: 0.625rem;
    }
    #analysis-form {
        label {
            display: inline;
        }
    }
    .templateslist {
        td.cell.action {
            width: 10%;
        }
        th.header.action {
            width: 10%;
        }
    }
    .feedback-item-label {
        width: 100%;
    }
    // Feedback edit form.
    #feedback_edit_form {
        [id*=_feedback_item_].feedback_itemlist,
        .feedback_itemlist.sortable-list-is-dragged {
            padding: 0.75rem;
    border: 1px solid;
    border-color: #e5e7eb;
    background-color: #ffffff;
    position: relative;
    border-radius: 0.375rem;
            .itemname {
                margin-right: 1.25rem;
            }
            .itemactions {
                position: absolute;
                top: 0.75rem;
                right: 0.75rem;
            }
            &.sortable-list-current-position {
                background-color: #f3f4f6;
            }
        }
        .sortable-list-is-dragged {
            opacity: 0.75;
            max-width: 830px;
        }
        .loading-icon {
            position: absolute;
            left: 50%;
            top: calc(50% - 0.5rem);
        }
    }

    // Templates page.
    &#page-mod-feedback-manage_templates {
        .coursetemplates,
        .publictemplates {
            .no-overflow {
                overflow: visible;
            }
            .action-menu .menubar {
                justify-content: flex-end;
            }
        }
    }

    // Analysis page.
    table.analysis {
        width: 100%;
        border-top: 1px solid #e5e7eb;
        margin-top: 0.625rem;
        &.itemtype_textarea td {
            padding-top: 0.25rem; padding-bottom: 0.25rem;
    padding-left: 0; padding-right: 0;
        }
        tr:first-child th {
            padding-top: 0.625rem;
        }
        tr:hover {
            background-color: #d1d5db;
        }
        td.singlevalue:before,
        td.optionname:before {
            content: '- ';
        }
        tr.isempty {
            display: none;
        }
    }

    // Responses list.
    #showentrytable td.cell.completed_timemodified,
    #showentryanontable td.cell.random_response {
        font-weight: 700;
    }

    #showentrytable td.cell.userpic,
    #showentrytable td.cell.deleteentry,
    #showentryanontable td.cell.deleteentry {
        width: 0.625rem;
    }

    // Responses navigation.
    .response_navigation {
        margin-top: 0.5rem;
        margin-bottom: 0.5rem;
        a {
            display: block;
            &.back_to_list {
                text-align: center;
            }
        }
        .prev_response {
            text-align: left;
            &:before {
                /*rtl:raw:
                content: ' ► ';
                */
                /*rtl:remove*/
                content: ' ◄ ';
            }
        }
        .next_response {
            text-align: right;
            &:after {
                /*rtl:raw:
                content: ' ◄ ';
                */
                /*rtl:remove*/
                content: ' ► ';
            }
        }
    }
}
